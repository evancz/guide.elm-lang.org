
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Random Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="http.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../install.html">
            
                <a href="../../install.html">
            
                    
                    Install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../core_language.html">
            
                <a href="../../core_language.html">
            
                    
                    Core Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../">
            
                <a href="../">
            
                    
                    The Elm Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../user_input/">
            
                <a href="../user_input/">
            
                    
                    User Input
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../user_input/buttons.html">
            
                <a href="../user_input/buttons.html">
            
                    
                    Buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../user_input/text_fields.html">
            
                <a href="../user_input/text_fields.html">
            
                    
                    Text Fields
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../user_input/forms.html">
            
                <a href="../user_input/forms.html">
            
                    
                    Forms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../user_input/more.html">
            
                <a href="../user_input/more.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="./">
            
                <a href="./">
            
                    
                    Effects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.2.1" data-path="random.html">
            
                <a href="random.html">
            
                    
                    Random
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="http.html">
            
                <a href="http.html">
            
                    
                    HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="time.html">
            
                <a href="time.html">
            
                    
                    Time
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="web_sockets.html">
            
                <a href="web_sockets.html">
            
                    
                    Web Sockets
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../more.html">
            
                <a href="../more.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../types/">
            
                <a href="../../types/">
            
                    
                    Types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../types/reading_types.html">
            
                <a href="../../types/reading_types.html">
            
                    
                    Reading Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../types/type_aliases.html">
            
                <a href="../../types/type_aliases.html">
            
                    
                    Type Aliases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../types/union_types.html">
            
                <a href="../../types/union_types.html">
            
                    
                    Union Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../error_handling/">
            
                <a href="../../error_handling/">
            
                    
                    Error Handling and Tasks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../error_handling/maybe.html">
            
                <a href="../../error_handling/maybe.html">
            
                    
                    Maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../error_handling/result.html">
            
                <a href="../../error_handling/result.html">
            
                    
                    Result
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../error_handling/task.html">
            
                <a href="../../error_handling/task.html">
            
                    
                    Task
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../interop/">
            
                <a href="../../interop/">
            
                    
                    Interop
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../interop/json.html">
            
                <a href="../../interop/json.html">
            
                    
                    JSON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../interop/javascript.html">
            
                <a href="../../interop/javascript.html">
            
                    
                    JavaScript
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../reuse/">
            
                <a href="../../reuse/">
            
                    
                    Scaling The Elm Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../reuse/checkboxes.html">
            
                <a href="../../reuse/checkboxes.html">
            
                    
                    Labeled Checkboxes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../reuse/radio_buttons.html">
            
                <a href="../../reuse/radio_buttons.html">
            
                    
                    Radio Buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../reuse/modules.html">
            
                <a href="../../reuse/modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../../reuse/more.html">
            
                <a href="../../reuse/more.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Random</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="random">Random</h1>
<hr>
<h4 id="clone-the-code-or-follow-along-in-the-online-editor"><a href="https://github.com/evancz/elm-architecture-tutorial/" target="_blank">Clone the code</a> or follow along in the <a href="http://elm-lang.org/examples/random" target="_blank">online editor</a>.</h4>
<hr>
<p>We are about to make an app that &quot;rolls dice&quot;, producing a random number between 1 and 6.</p>
<p>When I write code with effects, I usually break it into two phases. Phase one is about getting something on screen, just doing the bare minimum to have something to work from. Phase two is filling in details, gradually approaching the actual goal. We will use this process here too.</p>
<h2 id="phase-one---the-bare-minimum">Phase One - The Bare Minimum</h2>
<p>As always, you start out by guessing at what your <code>Model</code> should be:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Model</span> =
  { dieFace : <span class="hljs-type">Int</span>
  }
</code></pre>
<p>For now we will just track <code>dieFace</code> as an integer between 1 and 6. Then I would quickly sketch out the <code>view</code> function because it seems like the easiest next step.</p>
<pre><code class="lang-elm"><span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">view</span> model =
  div []
    [ h1 [] [ text (toString model.dieFace) ]
    , button [ onClick <span class="hljs-type">Roll</span> ] [ text <span class="hljs-string">&quot;Roll&quot;</span> ]
    ]
</code></pre>
<p>So this is typical. Same stuff we have been doing with the user input examples of The Elm Architecture. When you click our <code>&lt;button&gt;</code> it is going to produce a <code>Roll</code> message, so I guess it is time to take a first pass at the <code>update</code> function as well.</p>
<pre><code class="lang-elm"><span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span> = <span class="hljs-type">Roll</span>

<span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">update</span> msg model =
  <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
    <span class="hljs-type">Roll</span> -&gt;
      (model, <span class="hljs-type">Cmd</span>.none)
</code></pre>
<p>Now the <code>update</code> function has the same overall shape as before, but the return type is a bit different. Instead of just giving back a <code>Model</code>, it produces both a <code>Model</code> and a command. The idea is: <strong>we still want to step the model forward, but we also want to do some stuff.</strong> In our case, we want to ask Elm to give us a random value. For now, I just fill it in with <a href="http://package.elm-lang.org/packages/elm-lang/core/latest/Platform-Cmd#none" target="_blank"><code>Cmd.none</code></a> which means &quot;I have no commands, do nothing.&quot; We will fill this in with the good stuff in phase two.</p>
<p>Finally, I would create an <code>init</code> value like this:</p>
<pre><code class="lang-elm"><span class="hljs-title">init</span> : (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">init</span> =
  (<span class="hljs-type">Model</span> <span class="hljs-number">1</span>, <span class="hljs-type">Cmd</span>.none)
</code></pre>
<p>Here we specify both the initial model and some commands we&apos;d like to run immediately when the app starts. This is exactly the kind of stuff that <code>update</code> is producing now too.</p>
<p>While we aren&apos;t using subscriptions in this example, remember that the architecture skeleton has changed to include them. The <code>main</code> should reflect this, since we aren&apos;t using the <code>Html.beginnerProgram</code> anymore.</p>
<pre><code class="lang-elm"><span class="hljs-title">main</span> =
  <span class="hljs-type">Html</span>.program
    { init = init
    , view = view
    , update = update
    , subscriptions = subscriptions
    }
</code></pre>
<p>At this point, it is possible to wire it all up and take a look. You can click the <code>&lt;button&gt;</code>, but nothing happens. Let&apos;s fix that!</p>
<h2 id="phase-two---adding-the-cool-stuff">Phase Two - Adding the Cool Stuff</h2>
<p>The obvious thing missing right now is the randomness! When the user clicks a button we want to command Elm to reach into its internal random number generator and give us a number between 1 and 6. The first step I would take towards that goal would be adding a new kind of message:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
  = <span class="hljs-type">Roll</span>
  | <span class="hljs-type">NewFace</span> <span class="hljs-type">Int</span>
</code></pre>
<p>We still have <code>Roll</code> from before, but now we add <code>NewFace</code> for when Elm hands us our new random number. That is enough to start filling in <code>update</code>:</p>
<pre><code class="lang-elm"><span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">update</span> msg model =
  <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
    <span class="hljs-type">Roll</span> -&gt;
      (model, <span class="hljs-type">Random</span>.generate <span class="hljs-type">NewFace</span> (<span class="hljs-type">Random</span>.int <span class="hljs-number">1</span> <span class="hljs-number">6</span>))

    <span class="hljs-type">NewFace</span> newFace -&gt;
      (<span class="hljs-type">Model</span> newFace, <span class="hljs-type">Cmd</span>.none)
</code></pre>
<p>There are two new things here. <strong>First</strong>, there is now a branch for <code>NewFace</code> messages. When a <code>NewFace</code> comes in, we just step the model forward and do nothing. <strong>Second</strong>, we have added a real command to the <code>Roll</code> branch. This uses a couple functions from <a href="http://package.elm-lang.org/packages/elm-lang/core/latest/Random" target="_blank">the <code>Random</code> library</a>. Most important is <code>Random.generate</code>:</p>
<pre><code class="lang-elm"><span class="hljs-type">Random</span>.generate : (a -&gt; msg) -&gt; <span class="hljs-type">Random</span>.<span class="hljs-type">Generator</span> a -&gt; <span class="hljs-type">Cmd</span> msg
</code></pre>
<p>This function takes two arguments. The first is a function to tag random values. In our case we want to use <code>NewFace : Int -&gt; Msg</code> to turn the random number into a message for our <code>update</code> function. The second argument is a &quot;generator&quot; which is like a recipe for producing certain types of random values. You can have generators for simple types like <code>Int</code> or <code>Float</code> or <code>Bool</code>, but also for fancy types like big custom records with lots of fields. In this case, we use one of the simplest generators:</p>
<pre><code class="lang-elm"><span class="hljs-type">Random</span>.int : <span class="hljs-type">Int</span> -&gt; <span class="hljs-type">Int</span> -&gt; <span class="hljs-type">Random</span>.<span class="hljs-type">Generator</span> <span class="hljs-type">Int</span>
</code></pre>
<p>You provide a lower and upper bound on the integer, and now you have a generator that produces integers in that range!</p>
<p>That is it. Now we can click and see the number flip to some new value!</p>
<p>So the big lessons here are:</p>
<ul>
<li>Write your programs bit by bit. Start with a simple skeleton, and gradually add the tougher stuff.</li>
<li>The <code>update</code> function now produces a new model <em>and</em> a command.</li>
<li>You cannot just get random values willy-nilly. You create a command, and Elm will go do some work behind the scenes to provide it for you. In fact, any time our program needs to get unreliable values (randomness, HTTP, file I/O, database reads, etc.) you have to go through Elm.</li>
</ul>
<p>At this point, the best way to improve your understanding of commands is just to see more of them! They will appear prominently with the <code>Http</code> and <code>WebSocket</code> libraries, so if you are feeling shaky, the only path forward is practicing with randomness and playing with other examples of commands!</p>
<blockquote>
<p><strong>Exercises:</strong> Here are some that build on stuff that has already been introduced:</p>
<ul>
<li>Instead of showing a number, show the die face as an image.</li>
<li>Add a second die and have them both roll at the same time.</li>
</ul>
<p>And here are some that require new skills:</p>
<ul>
<li>Instead of showing an image of a die face, use the <code>elm-lang/svg</code> library to draw it yourself.</li>
<li>After you have learned about tasks and animation, have the die flip around randomly before they settle on a final value.</li>
</ul>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Effects">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="http.html" class="navigation navigation-next " aria-label="Next page: HTTP">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Random","level":"1.4.2.1","depth":3,"next":{"title":"HTTP","level":"1.4.2.2","depth":3,"path":"architecture/effects/http.md","ref":"architecture/effects/http.md","articles":[]},"previous":{"title":"Effects","level":"1.4.2","depth":2,"path":"architecture/effects/README.md","ref":"architecture/effects/README.md","articles":[{"title":"Random","level":"1.4.2.1","depth":3,"path":"architecture/effects/random.md","ref":"architecture/effects/random.md","articles":[]},{"title":"HTTP","level":"1.4.2.2","depth":3,"path":"architecture/effects/http.md","ref":"architecture/effects/http.md","articles":[]},{"title":"Time","level":"1.4.2.3","depth":3,"path":"architecture/effects/time.md","ref":"architecture/effects/time.md","articles":[]},{"title":"Web Sockets","level":"1.4.2.4","depth":3,"path":"architecture/effects/web_sockets.md","ref":"architecture/effects/web_sockets.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["ga","youtube","bulk-redirect"],"pluginsConfig":{"youtube":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"ga":{"configuration":"auto","token":"UA-25827182-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"architecture/effects/random.md","mtime":"2017-04-09T03:35:14.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-04-09T03:37:44.146Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

